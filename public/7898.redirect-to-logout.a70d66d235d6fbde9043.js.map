{"version":3,"file":"7898.redirect-to-logout.a70d66d235d6fbde9043.js","mappings":"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","sources":["webpack://merchant-center-custom-application/./node_modules/@commercetools-frontend/application-shell/dist/get-mc-origin-fecfee07.esm.js","webpack://merchant-center-custom-application/./node_modules/@commercetools-frontend/application-shell/dist/redirect-to-logout-9e54a707.esm.js","webpack://merchant-center-custom-application/./node_modules/@commercetools-frontend/application-shell/dist/redirector-54a03b75.esm.js"],"sourcesContent":["import _slicedToArray from '@babel/runtime-corejs3/helpers/esm/slicedToArray';\nimport _URL from '@babel/runtime-corejs3/core-js-stable/url';\nimport _reverseInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/reverse';\n\n/**\n * Get the \"real\" Merchant Center frontend URL to redirect the user\n * to the login page.\n * We use an explicit full URL so that if a user tries to access the\n * Custom Applications directly to its domain, it will always redirect\n * the user to the login page.\n *\n * To determine the \"real\" URL, we need to check if the current location\n * is a Merchant Center domain, or if it's a custom user domain.\n * For the latter, we can derive the URL from the Merchant Center API URL.\n *\n * A Merchant Center hostname is composed by the following parts:\n *    https://<mc-prefix>.<region>.<provider>.<ct-domain>.<tld>\n * We neeed to check if at least the first 4 parts (right-to-left) are\n * the same.\n */\nfunction getMcOrigin(mcApiUrl) {\n  var _context, _context2;\n  let actualWindow = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : window;\n  const mcApiUrlObject = new _URL(mcApiUrl);\n  const _mcApiUrlObject$hostn = _reverseInstanceProperty(_context = mcApiUrlObject.hostname.split('.')).call(_context),\n    _mcApiUrlObject$hostn2 = _slicedToArray(_mcApiUrlObject$hostn, 4),\n    tldMcApi = _mcApiUrlObject$hostn2[0],\n    ctDomainMcApi = _mcApiUrlObject$hostn2[1],\n    providerMcApi = _mcApiUrlObject$hostn2[2],\n    regionMcApi = _mcApiUrlObject$hostn2[3];\n  const _actualWindow$locatio = _reverseInstanceProperty(_context2 = actualWindow.location.hostname.split('.')).call(_context2),\n    _actualWindow$locatio2 = _slicedToArray(_actualWindow$locatio, 4),\n    tldMc = _actualWindow$locatio2[0],\n    ctDomainMc = _actualWindow$locatio2[1],\n    providerMc = _actualWindow$locatio2[2],\n    regionMc = _actualWindow$locatio2[3];\n  const isMatching = tldMcApi === tldMc && ctDomainMcApi === ctDomainMc && providerMcApi === providerMc && regionMcApi === regionMc;\n  if (isMatching) {\n    return actualWindow.location.origin;\n  }\n  return mcApiUrlObject.origin.replace('mc-api', 'mc');\n}\n\nexport { getMcOrigin as g };\n","import _Object$keys from '@babel/runtime-corejs3/core-js-stable/object/keys';\nimport _Object$getOwnPropertySymbols from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols';\nimport _filterInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/filter';\nimport _Object$getOwnPropertyDescriptor from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor';\nimport _forEachInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/for-each';\nimport _Object$getOwnPropertyDescriptors from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors';\nimport _Object$defineProperties from '@babel/runtime-corejs3/core-js-stable/object/define-properties';\nimport _Object$defineProperty from '@babel/runtime-corejs3/core-js-stable/object/define-property';\nimport _defineProperty from '@babel/runtime-corejs3/helpers/esm/defineProperty';\nimport { useLocation } from 'react-router-dom';\nimport { LOGOUT_REASONS } from '@commercetools-frontend/constants';\nimport { u as useIsServedByProxy } from './use-is-served-by-proxy-77984220.esm.js';\nimport { g as getMcOrigin } from './get-mc-origin-fecfee07.esm.js';\nimport { R as RedirectToLogin } from './index-4f6bae3a.esm.js';\nimport { R as Redirector } from './redirector-54a03b75.esm.js';\nimport { jsx } from '@emotion/react/jsx-runtime';\nimport '@commercetools-frontend/application-shell-connectors';\nimport '@babel/runtime-corejs3/helpers/slicedToArray';\nimport '@babel/runtime-corejs3/core-js-stable/url';\nimport '@babel/runtime-corejs3/core-js-stable/instance/reverse';\nimport 'prop-types';\nimport 'react';\nimport './index-89e5711a.esm.js';\nimport '@babel/runtime-corejs3/core-js-stable/instance/reduce';\nimport '@babel/runtime-corejs3/core-js-stable/object/entries';\nimport '@babel/runtime-corejs3/core-js-stable/reflect/has';\nimport '@reduxjs/toolkit';\nimport 'lodash/mapValues';\nimport 'omit-empty-es';\nimport 'redux-thunk';\nimport '@commercetools-frontend/notifications';\nimport '@commercetools-frontend/sdk';\nimport '@babel/runtime-corejs3/core-js-stable/instance/index-of';\nimport '@babel/runtime-corejs3/core-js-stable/instance/slice';\nimport '@babel/runtime-corejs3/core-js-stable/instance/includes';\nimport '@commercetools-frontend/sentry';\nimport '@commercetools-frontend/react-notifications';\nimport '@babel/runtime-corejs3/core-js-stable/instance/starts-with';\nimport 'redux-logger';\nimport '@emotion/styled/base';\nimport '@babel/runtime-corejs3/core-js-stable/instance/find';\nimport '@babel/runtime-corejs3/core-js-stable/array/is-array';\nimport '@emotion/react';\nimport '@commercetools-frontend/application-components';\nimport '@commercetools-frontend/i18n';\nimport './oidc-731e806d.esm.js';\nimport '@babel/runtime-corejs3/core-js-stable/instance/concat';\nimport '@babel/runtime-corejs3/core-js-stable/instance/map';\nimport '@commercetools-uikit/design-system';\nimport '@commercetools-uikit/spacings';\nimport 'react-intl';\nimport '@commercetools-uikit/flat-button';\nimport '@commercetools-uikit/icons';\nimport '@babel/runtime-corejs3/helpers/taggedTemplateLiteral';\nimport '@babel/runtime-corejs3/helpers/objectWithoutProperties';\nimport 'memoize-one';\nimport 'react-select';\nimport '@commercetools-uikit/accessible-hidden';\nimport '@commercetools-uikit/select-input';\nimport '@commercetools-uikit/text';\nimport '@commercetools-frontend/assets/images/ct-logo.svg';\nimport '@commercetools-uikit/loading-spinner';\nimport '@commercetools-frontend/browser-history';\nimport '@commercetools-frontend/l10n';\nimport '@babel/runtime-corejs3/core-js-stable/reflect/construct';\nimport '@babel/runtime-corejs3/helpers/classCallCheck';\nimport '@babel/runtime-corejs3/helpers/createClass';\nimport '@babel/runtime-corejs3/helpers/inherits';\nimport '@babel/runtime-corejs3/helpers/possibleConstructorReturn';\nimport '@babel/runtime-corejs3/helpers/getPrototypeOf';\nimport '@babel/runtime-corejs3/core-js-stable/set-timeout';\nimport '@babel/runtime-corejs3/core-js-stable/object/from-entries';\nimport '@babel/runtime-corejs3/core-js-stable/instance/flags';\nimport '@apollo/client/react';\nimport '@flopflip/combine-adapters';\nimport '@flopflip/http-adapter';\nimport '@flopflip/launchdarkly-adapter';\nimport '@flopflip/react-broadcast';\nimport 'react-redux';\nimport 'lodash/upperFirst';\nimport '@commercetools-uikit/design-system/materials/resets.css';\nimport '@commercetools-frontend/application-config/ssr';\nimport '@commercetools-frontend/permissions';\nimport '@flopflip/memory-adapter';\nimport '@babel/runtime-corejs3/core-js-stable/json/stringify';\nimport '@babel/runtime-corejs3/core-js-stable/instance/some';\nimport '@commercetools-frontend/actions-global';\nimport 'qss';\n\nfunction ownKeys(e, r) { var t = _Object$keys(e); if (_Object$getOwnPropertySymbols) { var o = _Object$getOwnPropertySymbols(e); r && (o = _filterInstanceProperty(o).call(o, function (r) { return _Object$getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var _context, _context2; var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? _forEachInstanceProperty(_context = ownKeys(Object(t), !0)).call(_context, function (r) { _defineProperty(e, r, t[r]); }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(e, _Object$getOwnPropertyDescriptors(t)) : _forEachInstanceProperty(_context2 = ownKeys(Object(t))).call(_context2, function (r) { _Object$defineProperty(e, r, _Object$getOwnPropertyDescriptor(t, r)); }); } return e; }\n// When the application redirects to this route, we always force a hard redirect\n// to the logout route of the authentication service.\nconst RedirectToLogout = props => {\n  var _window$app$__DEVELOP, _props$reason;\n  const location = useLocation();\n  const servedByProxy = useIsServedByProxy();\n  if ((_window$app$__DEVELOP = window.app.__DEVELOPMENT__) !== null && _window$app$__DEVELOP !== void 0 && (_window$app$__DEVELOP = _window$app$__DEVELOP.oidc) !== null && _window$app$__DEVELOP !== void 0 && _window$app$__DEVELOP.authorizeUrl) {\n    return jsx(RedirectToLogin, {});\n  }\n  const mcOrigin = servedByProxy ? getMcOrigin(window.app.mcApiUrl) : undefined;\n  return jsx(Redirector, {\n    to: \"logout\",\n    origin: mcOrigin,\n    location: location,\n    queryParams: _objectSpread({\n      reason: (_props$reason = props.reason) !== null && _props$reason !== void 0 ? _props$reason : LOGOUT_REASONS.USER\n    }, servedByProxy ? {} : {\n      // This will be used after being logged in, to redirect to this location.\n      redirectTo: window.location.origin\n    })\n  });\n};\n\nexport { RedirectToLogout as default };\n","import _Object$keys from '@babel/runtime-corejs3/core-js-stable/object/keys';\nimport _Object$getOwnPropertySymbols from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols';\nimport _filterInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/filter';\nimport _Object$getOwnPropertyDescriptor from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor';\nimport _forEachInstanceProperty from '@babel/runtime-corejs3/core-js-stable/instance/for-each';\nimport _Object$getOwnPropertyDescriptors from '@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors';\nimport _Object$defineProperties from '@babel/runtime-corejs3/core-js-stable/object/define-properties';\nimport _Object$defineProperty from '@babel/runtime-corejs3/core-js-stable/object/define-property';\nimport _defineProperty from '@babel/runtime-corejs3/helpers/esm/defineProperty';\nimport _pt from 'prop-types';\nimport _URL from '@babel/runtime-corejs3/core-js-stable/url';\nimport { useCallback, useEffect } from 'react';\nimport { encode } from 'qss';\nimport { l as location } from './use-is-served-by-proxy-77984220.esm.js';\n\nfunction ownKeys(e, r) { var t = _Object$keys(e); if (_Object$getOwnPropertySymbols) { var o = _Object$getOwnPropertySymbols(e); r && (o = _filterInstanceProperty(o).call(o, function (r) { return _Object$getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var _context, _context2; var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? _forEachInstanceProperty(_context = ownKeys(Object(t), !0)).call(_context, function (r) { _defineProperty(e, r, t[r]); }) : _Object$getOwnPropertyDescriptors ? _Object$defineProperties(e, _Object$getOwnPropertyDescriptors(t)) : _forEachInstanceProperty(_context2 = ownKeys(Object(t))).call(_context2, function (r) { _Object$defineProperty(e, r, _Object$getOwnPropertyDescriptor(t, r)); }); } return e; }\nconst redirectTo = targetUrl => {\n  location.replace(targetUrl);\n};\nconst useRedirector = () => {\n  const redirector = useCallback(options => {\n    var _options$origin, _options$queryParams, _enhancedLocation$que;\n    // For now the authentication service runs on the same domain as the application,\n    // even on development (using the webpack dev server).\n    const originUrl = (_options$origin = options.origin) !== null && _options$origin !== void 0 ? _options$origin : window.location.origin;\n    const enhancedLocation = options.location || {};\n    const searchQuery = _objectSpread(_objectSpread({}, (_options$queryParams = options.queryParams) !== null && _options$queryParams !== void 0 ? _options$queryParams : {}), (_enhancedLocation$que = enhancedLocation.query) !== null && _enhancedLocation$que !== void 0 ? _enhancedLocation$que : {});\n    const targetUrlObject = new _URL(originUrl);\n    targetUrlObject.pathname = options.to || targetUrlObject.pathname;\n    targetUrlObject.search = \"?\".concat(encode(searchQuery));\n    const targetUrl = targetUrlObject.toString();\n    redirectTo(targetUrl);\n  }, []);\n  return redirector;\n};\nconst Redirector = props => {\n  const redirector = useRedirector();\n  useEffect(() => {\n    redirector(props);\n    // Only execute once!\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return null;\n};\nRedirector.propTypes = {\n  to: _pt.string.isRequired,\n  origin: _pt.string,\n  queryParams: _pt.shape({\n    redirectTo: _pt.string,\n    client_id: _pt.string,\n    response_type: _pt.string,\n    scope: _pt.string,\n    state: _pt.string,\n    nonce: _pt.string\n  })\n};\nRedirector.displayName = 'Redirector';\n\nexport { Redirector as R, useRedirector as u };\n"],"names":["getMcOrigin","mcApiUrl","_context","_context2","actualWindow","arguments","length","undefined","window","mcApiUrlObject","_mcApiUrlObject$hostn","hostname","split","call","_mcApiUrlObject$hostn2","tldMcApi","ctDomainMcApi","providerMcApi","regionMcApi","_actualWindow$locatio","location","_actualWindow$locatio2","tldMc","ctDomainMc","providerMc","regionMc","origin","replace","ownKeys","e","r","t","o","enumerable","push","apply","_objectSpread","Object","RedirectToLogout","props","_window$app$__DEVELOP","_props$reason","servedByProxy","u","app","__DEVELOPMENT__","oidc","authorizeUrl","R","mcOrigin","g","to","queryParams","reason","redirectTo","useRedirector","useCallback","options","_options$origin","_options$queryParams","_enhancedLocation$que","originUrl","enhancedLocation","searchQuery","query","targetUrlObject","pathname","search","concat","targetUrl","l","toString","Redirector","redirector","useEffect","propTypes","client_id","response_type","scope","state","nonce","displayName"],"sourceRoot":""}