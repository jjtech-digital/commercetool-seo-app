"use strict";(self.webpackChunkmerchant_center_custom_application=self.webpackChunkmerchant_center_custom_application||[]).push([[7770],{"./src/routes.tsx":(e,t,a)=>{a.r(t),a.d(t,{default:()=>lt});var o=a("./node_modules/react-router/esm/react-router.js"),n=a("./node_modules/@commercetools-uikit/spacings/dist/commercetools-uikit-spacings.esm.js"),i=a("./node_modules/@babel/runtime-corejs3/helpers/esm/slicedToArray.js"),r=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/find.js"),l=a.n(r),s=a("./node_modules/@commercetools-uikit/flat-button/dist/commercetools-uikit-flat-button.esm.js"),c=a("./node_modules/@commercetools-uikit/icons/dist/commercetools-uikit-icons.esm.js"),u=a("./node_modules/@commercetools-uikit/text/dist/commercetools-uikit-text.esm.js"),d=a("./node_modules/react-router-dom/esm/react-router-dom.js");let p=function(e){return e.RULES="Rules",e.OPENAI="Open AI",e}({});var v=a("./node_modules/@babel/runtime-corejs3/core-js-stable/object/keys.js"),m=a.n(v),g=a("./node_modules/@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols.js"),_=a.n(g),f=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/filter.js"),b=a.n(f),h=a("./node_modules/@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor.js"),j=a.n(h),y=a("./node_modules/@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors.js"),S=a.n(y),D=a("./node_modules/@babel/runtime-corejs3/core-js-stable/object/define-properties.js"),w=a.n(D),R=a("./node_modules/@babel/runtime-corejs3/core-js-stable/object/define-property.js"),k=a.n(R),O=a("./node_modules/@babel/runtime-corejs3/helpers/esm/defineProperty.js"),Z=a("./node_modules/@babel/runtime-corejs3/core-js-stable/array/is-array.js"),T=a.n(Z),F=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/for-each.js"),M=a.n(F),P=a("./node_modules/react/index.js"),E=a("./node_modules/react-hook-form/dist/index.esm.mjs"),L=a("./src/context/AppContext.tsx"),A=a("./node_modules/@commercetools-uikit/loading-spinner/dist/commercetools-uikit-loading-spinner.esm.js");const C="Loader-module__loaderContainer___ZJDAO";var K=a("./node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const Loader_Loader=e=>{let t=e.shoudLoaderSpinnerShow,a=void 0===t||t,o=e.loadingMessage;return(0,K.BX)("div",{className:"".concat(C),children:[a&&(0,K.tZ)(A.Z,{}),o&&(0,K.tZ)("p",{children:o})]})};var I=a("./src/constants.ts"),x=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/map.js"),N=a.n(x),B=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/concat.js"),V=a.n(B),U=a("./node_modules/@babel/runtime-corejs3/core-js-stable/json/stringify.js"),q=a.n(U),G=a("./node_modules/axios/lib/axios.js");function ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const createRulesInCtCustomObj=async(e,t,a,o,n)=>{var i;const r=n.CTP_API_URL,l=n.CTP_PROJECT_KEY,s=N()(i=e.rulesContent).call(i,(e=>e.rulesInput)),c=localStorage.getItem(I.SH.CT_OBJ_TOKEN);try{var u;null===t||void 0===t||t((e=>_objectSpread(_objectSpread({},e),{},{isApiFetching:!0})));const e=V()(u="".concat(r,"/")).call(u,l,"/custom-objects"),n={container:"".concat(a),key:"".concat(o),value:s},i=await G.Z.post(e,q()(n),{headers:{Authorization:"Bearer ".concat(c),"Content-Type":"application/json"}});return null===t||void 0===t||t((e=>_objectSpread(_objectSpread({},e),{},{isApiFetching:!1}))),null===i||void 0===i?void 0:i.data}catch(d){return null===t||void 0===t||t((e=>_objectSpread(_objectSpread({},e),{},{isApiFetching:!1}))),console.error("Error creating rule",d),d}},getAllSavedRulesFromCtObj=async(e,t,a,o,n)=>{const i=t.CTP_API_URL,r=t.CTP_PROJECT_KEY;try{var l,s,c;null===n||void 0===n||n((e=>_objectSpread(_objectSpread({},e),{},{pageLoading:!0})));const t=V()(l=V()(s=V()(c="".concat(i,"/")).call(c,r,"/custom-objects/")).call(s,a,"/")).call(l,o),u=await G.Z.get(t,{headers:{Authorization:"Bearer ".concat(e)}});return null===n||void 0===n||n((e=>_objectSpread(_objectSpread({},e),{},{pageLoading:!1}))),null===u||void 0===u?void 0:u.data}catch(u){return null===n||void 0===n||n((e=>_objectSpread(_objectSpread({},e),{},{pageLoading:!1}))),console.error("Error fetching all rules:",u),u}},$="Settings-module__gridRuleDataSection___ek1kB",J="Settings-module__gridRuleInputWrapper___beqm2",X="Settings-module__gridRuleInputContainer___PvLZw",H="Settings-module__gridRuleInputStyle___BkO1h",Y="Settings-module__ruleFormSubmitButton___DZVh6",z="Settings-module__ruleHeading___novx2",W="Settings-module__actionButtonWrapper___DBzVu",Q="Settings-module__actionButtonsContainer___MaIGK";var ee=a("./node_modules/@commercetools-uikit/icon-button/dist/commercetools-uikit-icon-button.esm.js"),te=a("./node_modules/@commercetools-uikit/primary-button/dist/commercetools-uikit-primary-button.esm.js"),ae=a("./node_modules/@commercetools-uikit/secondary-button/dist/commercetools-uikit-secondary-button.esm.js");function SettingsRuleDataRender_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function SettingsRuleDataRender_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=SettingsRuleDataRender_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=SettingsRuleDataRender_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const RuleInputField=e=>{var t,a;let o=e.item,n=e.index,i=e.component;return(0,K.tZ)("div",{children:(0,K.BX)("div",{className:"".concat(J),children:[(0,K.BX)("div",{className:"".concat(X),children:[(0,K.tZ)("input",SettingsRuleDataRender_objectSpread(SettingsRuleDataRender_objectSpread({className:"".concat(H)},i.register("rulesContent.".concat(n,".rulesInput"),{required:"Rules Content is required"})),{},{placeholder:"Generate good content"})),(null===i||void 0===i||null===(t=i.errors)||void 0===t||null===(t=t.rulesContent)||void 0===t||null===(t=t[n])||void 0===t?void 0:t.rulesInput)&&(0,K.tZ)("div",{style:{color:"red",marginTop:"4px"},children:null===(a=i.errors.rulesContent[n])||void 0===a||null===(a=a.rulesInput)||void 0===a?void 0:a.message})]}),n===i.currentIndex?(0,K.tZ)(ee.Z,{icon:(0,K.tZ)(c.Oh,{}),label:"Add",onClick:i.handleAddField}):(0,K.tZ)(ee.Z,{icon:(0,K.tZ)(c.gH,{}),label:"Delete",onClick:()=>i.handleRemoveField(n)})]})},o.id)},RuleForm=e=>{var t;let a=e.component,o=e.isApiFetching;return(0,K.BX)("form",{onSubmit:a.handleSubmit(null===a||void 0===a?void 0:a.onSubmitFunction),className:"".concat($),children:[N()(t=a.fields).call(t,((e,t)=>(0,K.tZ)(RuleInputField,{item:e,index:t,component:a},e.id))),(0,K.tZ)("div",{className:"".concat(Y),children:o?(0,K.tZ)(ae.Z,{iconLeft:(0,K.tZ)(A.Z,{}),label:"Submitting",type:"submit",isDisabled:!0}):(0,K.tZ)(te.Z,{label:"Save",type:"submit"})})]})},SettingsData_SettingsRuleDataRender=e=>{let t=e.ruleComponents,a=e.state;return(0,K.tZ)("div",{children:null===t||void 0===t?void 0:N()(t).call(t,(e=>{const t=(()=>{switch(e.heading){case"Seo Rules":return a.isApiFetchingSEO;case"Description Rules":return a.isApiFetchingDescription;default:return a.isApiFetchingKeyFeatures}})();return(0,K.BX)("div",{children:[(0,K.tZ)("span",{className:"".concat(z),children:null===e||void 0===e?void 0:e.heading}),(0,K.tZ)(RuleForm,{component:e,isApiFetching:t})]},null===e||void 0===e?void 0:e.heading)}))})};var oe=a("./node_modules/@commercetools-frontend/application-shell-connectors/dist/commercetools-frontend-application-shell-connectors.esm.js");function SettingsRulesData_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function SettingsRulesData_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=SettingsRulesData_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=SettingsRulesData_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const SettingsData_SettingsRulesData=()=>{const e={CTP_API_URL:(0,oe.UV)((e=>e.environment.apiUrl)),CTP_PROJECT_KEY:(0,oe.UV)((e=>e.environment.projectKey))},t=(0,P.useState)({seo:0,description:0,keyFeatures:0}),a=(0,i.Z)(t,2),o=a[0],n=a[1],r=(0,L.b)(),l=r.state,s=r.setState,c=(0,E.cI)(),u=c.control,d=c.register,p=c.handleSubmit,v=c.formState.errors,m=(0,E.cI)(),g=m.control,_=m.register,f=m.handleSubmit,b=m.formState.errors,h=(0,E.cI)(),j=h.control,y=h.register,S=h.handleSubmit,D=h.formState.errors,w=(0,E.Dq)({control:u,name:"rulesContent"}),R=w.fields,k=w.append,O=w.remove,Z=(0,E.Dq)({control:g,name:"rulesContent"}),F=Z.fields,A=Z.append,C=Z.remove,x=(0,E.Dq)({control:j,name:"rulesContent"}),N=x.fields,B=x.append,V=x.remove,U=(0,P.useRef)({seo:!1,description:!1,keyFeatures:!1});(0,P.useEffect)((()=>{U.current.seo||0!==R.length?n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{seo:R.length-1}))):(k({rulesInput:"",deletable:!1}),U.current.seo=!0)}),[R,k]),(0,P.useEffect)((()=>{U.current.description||0!==F.length?n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{description:F.length-1}))):(A({rulesInput:"",deletable:!1}),U.current.description=!0)}),[F,A]),(0,P.useEffect)((()=>{U.current.keyFeatures||0!==N.length?n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{keyFeatures:N.length-1}))):(B({rulesInput:"",deletable:!1}),U.current.keyFeatures=!0)}),[N,B]),(0,P.useEffect)((()=>{const t=localStorage.getItem(I.SH.CT_OBJ_TOKEN);(async()=>{try{if(t){const o=await getAllSavedRulesFromCtObj(t,e,I._q,I.w1,s);var a;if(o&&T()(o.value))O(),M()(a=o.value).call(a,(e=>{k({rulesInput:e,deletable:!1})}))}}catch(o){console.error("Error fetching saved rules:",o)}})();(async()=>{try{if(t){const o=await getAllSavedRulesFromCtObj(t,e,I.NT,I.k_,s);var a;if(o&&T()(o.value))C(),M()(a=o.value).call(a,(e=>{A({rulesInput:e,deletable:!1})}))}}catch(o){console.error("Error fetching saved rules:",o)}})();(async()=>{try{if(t){const o=await getAllSavedRulesFromCtObj(t,e,I.uX,I.UF,s);var a;if(o&&T()(o.value))V(),M()(a=o.value).call(a,(e=>{B({rulesInput:e,deletable:!1})}))}}catch(o){console.error("Error fetching saved rules:",o)}})()}),[]);const handleAddField=e=>{"seo"===e?(k({rulesInput:"",deletable:!1}),n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{seo:R.length})))):"description"===e?(A({rulesInput:"",deletable:!1}),n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{description:F.length})))):"keyFeatures"===e&&(B({rulesInput:"",deletable:!1}),n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{keyFeatures:N.length}))))},handleRemoveField=(e,t)=>{"seo"===e?(O(t),n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{seo:R.length-2})))):"description"===e?(C(t),n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{description:F.length-2})))):"keyFeatures"===e&&(V(t),n((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{keyFeatures:N.length-2}))))},q=[{heading:"Seo Rules",onSubmitFunction:async(t,a)=>{null===a||void 0===a||a.preventDefault(),s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{isApiFetchingSEO:!0})));const o=t;try{const t=await createRulesInCtCustomObj(o,s,I._q,I.w1,e);s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{notificationMessage:null===t||void 0===t?void 0:t.message,notificationMessageType:"success"})))}catch(n){console.log(n)}finally{s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{isApiFetchingSEO:!1})))}},fields:R,register:d,errors:v,handleAddField:()=>handleAddField("seo"),handleRemoveField:e=>handleRemoveField("seo",e),currentIndex:o.seo,handleSubmit:p},{heading:"Description Rules",onSubmitFunction:async(t,a)=>{null===a||void 0===a||a.preventDefault(),s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{isApiFetchingDescription:!0})));const o=t;try{const t=await createRulesInCtCustomObj(o,s,I.NT,I.k_,e);s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{notificationMessage:null===t||void 0===t?void 0:t.message,notificationMessageType:"success"})))}catch(n){console.log(n)}finally{s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{isApiFetchingDescription:!1})))}},fields:F,register:_,errors:b,handleAddField:()=>handleAddField("description"),handleRemoveField:e=>handleRemoveField("description",e),currentIndex:o.description,handleSubmit:f},{heading:"Key Feature Rules",onSubmitFunction:async(t,a)=>{null===a||void 0===a||a.preventDefault(),s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{isApiFetchingKeyFeatures:!0})));const o=t;try{const t=await createRulesInCtCustomObj(o,s,I.uX,I.UF,e);s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{notificationMessage:null===t||void 0===t?void 0:t.message,notificationMessageType:"success"})))}catch(n){console.log(n)}finally{s((e=>SettingsRulesData_objectSpread(SettingsRulesData_objectSpread({},e),{},{isApiFetchingKeyFeatures:!1})))}},fields:N,register:y,errors:D,handleAddField:()=>handleAddField("keyFeatures"),handleRemoveField:e=>handleRemoveField("keyFeatures",e),currentIndex:o.keyFeatures,handleSubmit:S}];return l.pageLoading?(0,K.tZ)(Loader_Loader,{shoudLoaderSpinnerShow:!0,loadingMessage:"Loading..."}):(0,K.tZ)(SettingsData_SettingsRuleDataRender,{ruleComponents:q,state:l})};function aiKeyFetchers_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function aiKeyFetchers_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=aiKeyFetchers_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=aiKeyFetchers_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}function SettingsOpenAiData_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function SettingsOpenAiData_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=SettingsOpenAiData_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=SettingsOpenAiData_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const SettingsData_SettingsOpenAiData=()=>{const e={CTP_API_URL:(0,oe.UV)((e=>e.environment.apiUrl)),CTP_PROJECT_KEY:(0,oe.UV)((e=>e.environment.projectKey))},t=(0,L.b)(),a=t.state,o=t.setState,n=(0,E.cI)(),i=n.handleSubmit,r=n.register,l=n.formState.errors,s=n.setValue,fetchKey=async()=>{try{const t=await(async(e,t)=>{const a=t.CTP_API_URL,o=t.CTP_PROJECT_KEY,n=localStorage.getItem(I.SH.CT_OBJ_TOKEN);try{var i,r,l;e((e=>aiKeyFetchers_objectSpread(aiKeyFetchers_objectSpread({},e),{},{pageLoading:!0})));const t=V()(i=V()(r=V()(l="".concat(a,"/")).call(l,o,"/custom-objects/")).call(r,I.Wm,"/")).call(i,I.GE),s=await G.Z.get(t,{headers:{Authorization:"Bearer ".concat(n)}});return e((e=>aiKeyFetchers_objectSpread(aiKeyFetchers_objectSpread({},e),{},{pageLoading:!1}))),s.data}catch(s){return e((e=>aiKeyFetchers_objectSpread(aiKeyFetchers_objectSpread({},e),{},{pageLoading:!1}))),console.error("Error fetching saved key:",s),s}})(o,e);t.value&&(localStorage.setItem(I.SH.OPEN_AI_KEY,t.value),s("openAi",t.value))}catch(t){console.error("Error fetching key:",t)}};return(0,P.useEffect)((()=>{fetchKey()}),[]),a.pageLoading?(0,K.tZ)(Loader_Loader,{shoudLoaderSpinnerShow:!0,loadingMessage:"Loading..."}):(0,K.tZ)("div",{children:(0,K.BX)("form",{onSubmit:i((async(t,a)=>{null===a||void 0===a||a.preventDefault();try{const a=await(async(e,t,a)=>{const o=a.CTP_API_URL,n=a.CTP_PROJECT_KEY,i=localStorage.getItem(I.SH.CT_OBJ_TOKEN);try{var r;t((e=>aiKeyFetchers_objectSpread(aiKeyFetchers_objectSpread({},e),{},{isApiFetching:!0})));const a=V()(r="".concat(o,"/")).call(r,n,"/custom-objects"),l={container:I.Wm,key:I.GE,value:e},s=await G.Z.post(a,q()(l),{headers:{Authorization:"Bearer ".concat(i),"Content-Type":"application/json"}});return t((e=>aiKeyFetchers_objectSpread(aiKeyFetchers_objectSpread({},e),{},{isApiFetching:!1}))),s.data}catch(l){return t((e=>aiKeyFetchers_objectSpread(aiKeyFetchers_objectSpread({},e),{},{isApiFetching:!1}))),console.error("Error saving key:",l),l}})(t.openAi,o,e);localStorage.setItem(I.SH.OPEN_AI_KEY,null===a||void 0===a?void 0:a.value),o((e=>SettingsOpenAiData_objectSpread(SettingsOpenAiData_objectSpread({},e),{},{notificationMessage:(null===a||void 0===a?void 0:a.message)||"Key saved successfully.",notificationMessageType:"success"})))}catch(n){o((e=>SettingsOpenAiData_objectSpread(SettingsOpenAiData_objectSpread({},e),{},{notificationMessage:"Failed to save key",notificationMessageType:"error"})))}})),className:"".concat($),children:[(0,K.tZ)("div",{className:"".concat(J),children:(0,K.BX)("div",{className:"".concat(X),children:[(0,K.tZ)("input",SettingsOpenAiData_objectSpread(SettingsOpenAiData_objectSpread({className:"".concat(H)},r("openAi",{required:"This field is required is required"})),{},{placeholder:"Enter OpenAI key"})),(null===l||void 0===l?void 0:l.openAi)&&(0,K.tZ)("div",{style:{color:"red",marginTop:"4px"},children:l.openAi.message})]})}),(0,K.tZ)("div",{className:"".concat(Y),children:null!==a&&void 0!==a&&a.isApiFetchingSEO?(0,K.tZ)(ae.Z,{iconLeft:(0,K.tZ)(A.Z,{}),label:"Submitting",type:"submit",isDisabled:!0}):(0,K.tZ)(te.Z,{label:"Submit",type:"submit"})})]})})},SettingsData_SettingsData=e=>{let t=e.defaultPage;return(0,K.tZ)("div",{children:(()=>{switch(null===t||void 0===t?void 0:t.title){case p.RULES:return(0,K.tZ)(SettingsData_SettingsRulesData,{});case p.OPENAI:return(0,K.tZ)(SettingsData_SettingsOpenAiData,{});default:return null}})()})},ne=[{title:"Rules",isDefaultSelected:!0,name:"rules"},{title:"Open AI",isDefaultSelected:!1,name:"openai"}];var ie=a("./node_modules/@commercetools-uikit/view-switcher/dist/commercetools-uikit-view-switcher.esm.js");function TabToggler_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function TabToggler_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=TabToggler_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=TabToggler_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const TabToggler_TabToggler=e=>{let t=e.defaultPage,a=e.selectedPage,o=e.setSelectedPage;return(0,K.tZ)("div",{children:(0,K.tZ)(ie.Z.Group,{defaultSelected:null===t||void 0===t?void 0:t.name,onChange:e=>(e=>{const t=N()(a).call(a,(t=>t.name===e?TabToggler_objectSpread(TabToggler_objectSpread({},t),{},{isDefaultSelected:!0}):TabToggler_objectSpread(TabToggler_objectSpread({},t),{},{isDefaultSelected:!1})));o(t)})(e),children:N()(a).call(a,(e=>(0,K.tZ)(ie.Z.Button,{value:null===e||void 0===e?void 0:e.name,children:null===e||void 0===e?void 0:e.title},null===e||void 0===e?void 0:e.name)))})})},Settings_Settings=e=>{const t=(0,P.useState)(ne),a=(0,i.Z)(t,2),o=a[0],r=a[1],p=null===o||void 0===o?void 0:l()(o).call(o,(e=>e.isDefaultSelected));return(0,K.BX)(n.Z.Stack,{scale:"xl",children:[(0,K.BX)(n.Z.Stack,{scale:"xs",children:[(0,K.tZ)(s.Z,{as:d.rU,to:e.linkToProducts,label:"Back to Products",icon:(0,K.tZ)(c.xC,{})}),(0,K.tZ)(u.Z.Headline,{as:"h2",children:"Settings"})]}),(0,K.tZ)(TabToggler_TabToggler,{defaultPage:p,selectedPage:o,setSelectedPage:r}),p&&(0,K.tZ)(SettingsData_SettingsData,{defaultPage:p})]})};var re=a("./node_modules/@babel/runtime-corejs3/core-js-stable/set-timeout.js"),le=a.n(re),se=a("./node_modules/@commercetools-uikit/notifications/dist/commercetools-uikit-notifications.esm.js");const ce="Notification-module__notificationBottom___irkPu";function Notification_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function Notification_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=Notification_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=Notification_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const Notification_Notification=e=>{let t=e.successMessage,a=e.setSuccessMessage,o=e.type,n=void 0===o?"success":o;const handleNotificationDismiss=()=>{a((e=>Notification_objectSpread(Notification_objectSpread({},e),{},{notificationMessage:"",notificationMessageType:""})))};return(0,P.useEffect)((()=>{if(t){const e=le()((()=>{handleNotificationDismiss()}),3e3);return()=>clearTimeout(e)}}),[t]),(0,K.tZ)("div",{className:"".concat(ce),children:(0,K.tZ)(se.I,{type:n,onRemove:handleNotificationDismiss,children:t})})},ue="TableContainer-module__tableContainer___N7L9m",de="TableContainer-module__tableSearchSection___YHsdz",pe="TableContainer-module__searchBar___HGCfW",ve="TableContainer-module__actionContainer___H_2b_",me="TableContainer-module__actionButons___FJW2E",ge="TableContainer-module__settingIcon___PE91G",_e="TableContainer-module__emptyState___hI9dL",fe="TableContainer-module__navContainer____dJEf",be=[{title:"SEO",isDefaultSelected:!0,name:"seo"},{title:"Description",isDefaultSelected:!1,name:"description"}];let he=function(e){return e.SEO="SEO",e.DESCRIPTION="Description",e}({});var je=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/find-index.js"),ye=a.n(je),Se=(a("./node_modules/ag-grid-community/styles/ag-grid.css"),a("./node_modules/ag-grid-community/styles/ag-theme-quartz.css"),a("./node_modules/@commercetools-uikit/hooks/dist/commercetools-uikit-hooks.esm.js")),De=a("./node_modules/@commercetools/platform-sdk/dist/commercetools-platform-sdk.browser.esm.js"),we=a("./node_modules/@commercetools/sdk-client-v2/dist/commercetools-sdk-client-v2.browser.esm.js"),Re=a("./node_modules/node-fetch/browser.js"),ke=a.n(Re);const Oe={host:"https://auth.australia-southeast1.gcp.commercetools.com",projectKey:"jj-custom-app",credentials:{clientId:"xZVC4aex0a0MaWLtQ8mk6ZZM",clientSecret:"Wq0FXRJSQpbsxHDKIU6ObdebuiQDJVAs"},scopes:["view_connectors:jj-custom-app view_attribute_groups:jj-custom-app manage_stores:jj-custom-app manage_types:jj-custom-app manage_project:jj-custom-app manage_my_business_units:jj-custom-app manage_cart_discounts:jj-custom-app view_orders:jj-custom-app view_shipping_methods:jj-custom-app view_connectors_deployments:jj-custom-app manage_audit_log:jj-custom-app view_stores:jj-custom-app manage_checkout_payment_intents:jj-custom-app manage_states:jj-custom-app manage_products:jj-custom-app view_staged_quotes:jj-custom-app manage_my_payments:jj-custom-app manage_my_orders:jj-custom-app manage_my_quotes:jj-custom-app view_messages:jj-custom-app view_customers:jj-custom-app manage_categories:jj-custom-app manage_associate_roles:jj-custom-app view_cart_discounts:jj-custom-app view_categories:jj-custom-app manage_sessions:jj-custom-app view_quote_requests:jj-custom-app manage_tax_categories:jj-custom-app view_payments:jj-custom-app view_project_settings:jj-custom-app view_tax_categories:jj-custom-app view_customer_groups:jj-custom-app manage_payments:jj-custom-app manage_product_selections:jj-custom-app view_states:jj-custom-app manage_project_settings:jj-custom-app view_associate_roles:jj-custom-app introspect_oauth_tokens:jj-custom-app create_anonymous_token:jj-custom-app manage_subscriptions:jj-custom-app manage_api_clients:jj-custom-app view_business_units:jj-custom-app view_types:jj-custom-app manage_my_quote_requests:jj-custom-app view_products:jj-custom-app manage_customers:jj-custom-app manage_business_units:jj-custom-app manage_import_containers:jj-custom-app manage_discount_codes:jj-custom-app view_standalone_prices:jj-custom-app manage_orders:jj-custom-app manage_standalone_prices:jj-custom-app view_quotes:jj-custom-app view_shopping_lists:jj-custom-app manage_my_shopping_lists:jj-custom-app manage_my_profile:jj-custom-app view_order_edits:jj-custom-app manage_shipping_methods:jj-custom-app view_sessions:jj-custom-app view_product_selections:jj-custom-app manage_connectors:jj-custom-app manage_quotes:jj-custom-app manage_shopping_lists:jj-custom-app view_audit_log:jj-custom-app manage_extensions:jj-custom-app manage_attribute_groups:jj-custom-app manage_staged_quotes:jj-custom-app view_import_containers:jj-custom-app manage_quote_requests:jj-custom-app manage_connectors_deployments:jj-custom-app manage_order_edits:jj-custom-app view_discount_codes:jj-custom-app manage_customer_groups:jj-custom-app"],fetch:ke()},Ze={host:"https://api.australia-southeast1.gcp.commercetools.com",fetch:ke()},Te=(new we.Qx).withClientCredentialsFlow(Oe).withHttpMiddleware(Ze).build(),Fe=(0,De.mv_)(Te).withProjectKey({projectKey:"jj-custom-app"});var Me=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/starts-with.js"),Pe=a.n(Me),Ee=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/ends-with.js"),Le=a.n(Ee),Ae=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/slice.js"),Ce=a.n(Ae);function utils_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function utils_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=utils_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=utils_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const Ke=[{field:"productKey",flex:1,minWidth:140,editable:!1,headerCheckboxSelection:!0,checkboxSelection:!0,valueGetter:e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.key}},{field:"name",flex:3.5,editable:!1,valueGetter:e=>{var t;return null===(t=e.data)||void 0===t||null===(t=t.masterData)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.name}}],performSearch=async(e,t,a,o,n,i,r)=>{const l=a.dataLocale,s=a.perPage,c=a.offSet;r(!0);try{if(!t)return void o((e=>utils_objectSpread(utils_objectSpread({},e),{},{notificationMessage:"Search field cannot be empty.",notificationMessageType:"error"})));if(!l)throw new Error("Locale is not defined");o((e=>utils_objectSpread(utils_objectSpread({},e),{},{pageLoading:!0})));const a=await e.productProjections().search().get({queryArgs:{["text.".concat(l)]:t,limit:null===s||void 0===s?void 0:s.value,offset:c}}).execute();return o((e=>utils_objectSpread(utils_objectSpread({},e),{},{pageLoading:!1}))),a}catch(u){console.error("Search failed:",u),o((e=>utils_objectSpread(utils_objectSpread({},e),{},{pageLoading:!1,notificationMessage:"Search failed. Please try again later.",notificationMessageType:"error"})))}},fetchProductData=async(e,t,a,o,n,i,r)=>{const l=a.perPage,s=a.offSet;r(!1);try{var c,u;o((e=>utils_objectSpread(utils_objectSpread({},e),{},{pageLoading:!0})));const a=await e.graphql().post({body:{query:"query ($limit: Int, $offset: Int, $Locale: Locale, $LocaleProjection: [Locale!]) {\n      products(limit: $limit, offset: $offset, localeProjection: $LocaleProjection) {\n        total\n        offset\n        results {\n          id\n          key\n          version\n          masterData {\n            current {\n              name(locale: $Locale)\n              nameAllLocales {\n                locale\n                value\n              }\n              masterVariant {\n                attributesRaw {\n                  name\n                  value\n                }\n              }\n              categories {\n                name(locale: $Locale)\n                slug(locale: $Locale)\n              }\n              description(locale : $Locale)\n              descriptionAllLocales {\n                locale\n                value\n              }\n              metaTitle(locale: $Locale)\n              metaDescription(locale: $Locale)\n              metaTitleAllLocales {\n                locale\n                value\n              }\n              metaDescriptionAllLocales {\n                locale\n                value\n              }\n            }\n          }\n        }\n      }\n    }\n    ",variables:{limit:Number(null===l||void 0===l?void 0:l.value),offset:Number(s),Locale:t}}}).execute();o((e=>utils_objectSpread(utils_objectSpread({},e),{},{pageLoading:!1}))),n(null===a||void 0===a||null===(c=a.body)||void 0===c||null===(c=c.data)||void 0===c||null===(c=c.products)||void 0===c?void 0:c.total),i(null===a||void 0===a||null===(u=a.body)||void 0===u||null===(u=u.data)||void 0===u||null===(u=u.products)||void 0===u?void 0:u.results)}catch(d){console.error("Error fetching product data:",d),o((e=>utils_objectSpread(utils_objectSpread({},e),{},{pageLoading:!1,notificationMessage:"Error fetching product data. Please try again later.",notificationMessageType:"error"})))}},removeDoubleQuotes=e=>null!==e&&void 0!==e&&Pe()(e).call(e,'"')&&null!==e&&void 0!==e&&Le()(e).call(e,'"')?null===e||void 0===e?void 0:Ce()(e).call(e,1,-1):e;var Ie=a("./node_modules/@commercetools-uikit/search-text-input/dist/commercetools-uikit-search-text-input.esm.js"),xe=a("./node_modules/@commercetools-uikit/pagination/dist/commercetools-uikit-pagination.esm.js");const TableContainer_SearchPerformed=e=>{const t=e.searchPerformed;return(0,K.tZ)(u.Z.Body,{children:t?"No products found matching your search criteria.":"No products available."})};var Ne=a("./node_modules/@commercetools-uikit/buttons/node_modules/@commercetools-uikit/primary-button/dist/commercetools-uikit-primary-button.esm.js");const TableContainer_BulkUpdateButtonSection=e=>{let t=e.selectedRows,a=e.handleGenerate,o=e.handleApply,n=e.gridRef;return(0,K.tZ)("div",{className:"".concat(ve),children:null!==t&&(null===t||void 0===t?void 0:t.length)>0&&(0,K.BX)("div",{className:"".concat(me),children:[(0,K.tZ)(Ne.Z,{size:"medium",label:"Generate",onClick:a,isDisabled:!1}),(0,K.tZ)(Ne.Z,{size:"medium",label:"Cancel",onClick:()=>{var e;return null===n||void 0===n||null===(e=n.current)||void 0===e||null===(e=e.api)||void 0===e?void 0:e.stopEditing(!0)},isDisabled:!1}),(0,K.tZ)(Ne.Z,{size:"medium",label:"Apply",onClick:o,isDisabled:!1})]})})};var Be=a("./node_modules/ag-grid-react/dist/package/index.esm.mjs");const Ve="CustomLoadingOverlay-module__loadingOverlay___xxWuq",Ue="CustomLoadingOverlay-module__loadingDots___DvfyT",CustomLoadingOverlay_CustomLoadingOverlay=e=>{var t;return(0,K.tZ)("div",{className:"ag-overlay-loading-center",children:(0,K.BX)("div",{"aria-live":"polite","aria-atomic":"true",className:"".concat(Ve),children:[null===e||void 0===e||null===(t=e.context)||void 0===t?void 0:t.loadingOverlayMessage,"",(0,K.tZ)("span",{className:"".concat(Ue),children:"..."})]})})},qe="CustomTooltip-module__customTooltip___XsGlS",CustomTooltip_CustomTooltip=e=>(0,K.tZ)("div",{className:"".concat(qe),style:{backgroundColor:e.color||"#f9f5f5"},children:e.value}),TableContainer_GridContainer=e=>{let t=e.search,a=e.setSearch,o=e.handleSearch,n=e.fetchData,i=e.selectedRows,r=e.handleBulkGenerateClick,l=e.handleBulkApplyClick,s=e.gridRef,c=e.state,u=e.tableData,d=e.colDefs,p=e.context,v=e.onSelectionChanged,m=e.totalProductCount,g=e.page,_=e.perPage,f=e.searchPerformed,b=e.searchboxPlaceholder,h=e.components;const j=(0,P.useMemo)((()=>({width:"100%",height:"65vh"})),[]),y=((null===g||void 0===g?void 0:g.value)-1)*(null===_||void 0===_?void 0:_.value),S=(0,oe.UV)((e=>{var t;return{dataLocale:e.dataLocale,projectLanguages:null===(t=e.project)||void 0===t?void 0:t.languages}})),D=S.dataLocale,w=(0,P.useMemo)((()=>({flex:1,tooltipComponent:CustomTooltip_CustomTooltip})),[]),R=(0,P.useMemo)((()=>CustomLoadingOverlay_CustomLoadingOverlay),[]);return(0,P.useEffect)((()=>{t?o():n()}),[D,y,null===_||void 0===_?void 0:_.value]),(0,K.BX)("div",{className:"".concat(ue),children:[(0,K.BX)("div",{className:"".concat(de),children:[(0,K.tZ)("div",{className:"".concat(pe),children:(0,K.tZ)(Ie.Z,{placeholder:b,value:t,onChange:e=>a(String(e.target.value)),onSubmit:o,onReset:()=>{a(""),n()}})}),(0,K.tZ)(TableContainer_BulkUpdateButtonSection,{selectedRows:i,handleGenerate:r,handleApply:l,gridRef:s})]}),!c.pageLoading&&null!==u&&void 0!==u&&u.length?(0,K.BX)("div",{className:"ag-theme-quartz",style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,K.tZ)("div",{style:j,children:(0,K.tZ)(Be.s,{ref:s,rowData:u,columnDefs:d,defaultColDef:w,components:h,rowSelection:"multiple",suppressRowClickSelection:!0,tooltipShowDelay:1e3,tooltipInteraction:!0,reactiveCustomComponents:!0,onSelectionChanged:v,loadingOverlayComponent:R,context:p})}),(0,K.tZ)(xe.tl,{totalItems:m||0,page:null===g||void 0===g?void 0:g.value,onPageChange:null===g||void 0===g?void 0:g.onChange,perPage:null===_||void 0===_?void 0:_.value,onPerPageChange:null===_||void 0===_?void 0:_.onChange,perPageRange:"m"})]}):(0,K.tZ)("div",{className:"".concat(_e),children:c.pageLoading?(0,K.tZ)(Loader_Loader,{shoudLoaderSpinnerShow:!0,loadingMessage:"Loading..."}):(0,K.tZ)(TableContainer_SearchPerformed,{searchPerformed:f})})]})},Ge="SimpleTextEditor-module__mySimpleEditorContainer___KJHvy",$e="SimpleTextEditor-module__mySimpleEditor___GH_CZ",Je="SimpleTextEditor-module__mySimpleEditorButtonContainer___ESoYc",Xe=(0,P.forwardRef)(((e,t)=>{const a=e.value,o=e.onValueChange,n=e.eventKey,updateValue=e=>{null===o||void 0===o||o(""===e?null:e)};(0,P.useEffect)((()=>{var e;let t;t="Backspace"===n?"":n&&1===n.length?n:a,null==t&&(t=""),updateValue(t),null===(e=i.current)||void 0===e||e.focus()}),[]);const i=(0,P.useRef)(null);return(0,K.BX)("div",{className:"".concat(Ge),children:[(0,K.tZ)("textarea",{value:a||"",ref:i,onChange:e=>updateValue(e.target.value),className:"".concat($e)}),(0,K.BX)("div",{className:"".concat(Je),children:[(0,K.tZ)(ee.Z,{icon:(0,K.tZ)(c.gH,{}),label:"CloseBoldIcon",size:"medium",onClick:()=>{updateValue(e.initialValue),e.stopEditing()}}),(0,K.tZ)(ee.Z,{icon:(0,K.tZ)(c.wN,{}),label:"CheckBoldIcon",size:"medium",onClick:()=>{updateValue(a),e.stopEditing()}})]})]})})),He=[...Ke,{field:"Description",headerName:"Description",flex:4,tooltipValueGetter:e=>e.value,valueGetter:e=>{var t;return null===(t=e.data)||void 0===t||null===(t=t.masterData)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.description},valueSetter:e=>(e.data.masterData.current.description=e.newValue,!0),editable:!0,sortable:!1,cellEditor:Xe,cellEditorPopup:!0},{field:"Key Features",headerName:"Key Features",flex:4,tooltipValueGetter:e=>e.value,valueGetter:e=>{var t,a;const o=localStorage.getItem("selectedDataLocale")||"en",n=null===(t=l()(a=e.data.masterData.current.masterVariant.attributesRaw).call(a,(e=>"features"===e.name)))||void 0===t||null===(t=t.value)||void 0===t?void 0:t[0];return null===n||void 0===n?void 0:n[o]},valueSetter:e=>{const t=localStorage.getItem("selectedDataLocale"),a=e.data.masterData.current.masterVariant.attributesRaw;let o=l()(a).call(a,(e=>"features"===e.name));return o?!!o&&(o.value[0][t]=e.newValue,!0):(o={name:"features",value:[{[t]:e.newValue}]},a.push(o),!0)},editable:!0,sortable:!1,cellEditor:Xe,cellEditorPopup:!0}],Ye=[...Ke,{field:"seoTitle",headerName:"SEO Title",flex:4,tooltipValueGetter:e=>e.value,valueGetter:e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t||null===(t=t.masterData)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.metaTitle},valueSetter:e=>(e.data.masterData.current.metaTitle=e.newValue,!0),editable:!0,sortable:!1,cellEditor:Xe,cellEditorPopup:!0},{field:"seoDescription",headerName:"SEO Description",flex:4,tooltipValueGetter:e=>e.value,valueGetter:e=>{var t;return null===(t=e.data)||void 0===t||null===(t=t.masterData)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.metaDescription},valueSetter:e=>(e.data.masterData.current.metaDescription=e.newValue,!0),editable:!0,sortable:!1,cellEditor:Xe,cellEditorPopup:!0}];var ze=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/some.js"),We=a.n(ze),Qe=a("./node_modules/@babel/runtime-corejs3/core-js-stable/promise.js"),et=a.n(Qe),tt=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/every.js"),at=a.n(tt),ot=a("./node_modules/openai/index.mjs"),nt=a("./node_modules/@babel/runtime-corejs3/core-js-stable/instance/trim.js"),it=a.n(nt);function fetchersFunction_utils_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function fetchersFunction_utils_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=fetchersFunction_utils_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=fetchersFunction_utils_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const rt=localStorage.getItem(I.SH.OPEN_AI_KEY),setNotification=(e,t,a)=>{e((e=>fetchersFunction_utils_objectSpread(fetchersFunction_utils_objectSpread({},e),{},{notificationMessage:t,notificationMessageType:a})))},processBatches=async(e,t,a,o,n,i,r)=>{const l=Math.ceil((null===e||void 0===e?void 0:e.length)/t);for(let c=0;c<l;c++){const l=c*t,u=Math.min((c+1)*t,e.length),d=Ce()(e).call(e,l,u);try{const e=N()(d).call(d,(async e=>await o(a.secrets,e,null===a||void 0===a?void 0:a.dataLocale,n))),t=await et().all(e);return(null===t||void 0===t?void 0:We()(t).call(t,(e=>{var t;return 401===(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.status)})))?(i((e=>fetchersFunction_utils_objectSpread(fetchersFunction_utils_objectSpread({},e),{},{notificationMessage:"Incorrect API key provided",notificationMessageType:"error"}))),null):(r(t),t)}catch(s){i((e=>fetchersFunction_utils_objectSpread(fetchersFunction_utils_objectSpread({},e),{},{notificationMessage:a.errorMessage,notificationMessageType:"error"}))),console.error(a.errorMessage,s)}}},matchData=e=>{var t,a,o;const n=null===e||void 0===e||null===(t=e.choices)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.message)||void 0===t?void 0:t.content,i=null===n||void 0===n?void 0:n.match(I.HE),r=i?it()(a=i[1]).call(a):null,l=null===n||void 0===n?void 0:n.match(I.Ys);return{keyFeatures:r,description:l?it()(o=l[1]).call(o):null}},seoMatchData=e=>{var t,a,o;const n=null===e||void 0===e||null===(t=e.choices)||void 0===t||null===(t=t[0])||void 0===t||null===(t=t.message)||void 0===t?void 0:t.content,i=null===n||void 0===n?void 0:n.match(I.J0),r=i?null===(a=i[2])||void 0===a?void 0:it()(a).call(a):null,l=null===n||void 0===n?void 0:n.match(I.AZ);return{title:r,description:l?null===(o=l[2])||void 0===o?void 0:it()(o).call(o):null}},getProductById=async(e,t)=>{try{const a=(await Fe.graphql().post({body:{query:"\n    fragment variantFields on ProductVariant {\n      sku\n      attributesRaw {\n        name\n        value\n      }\n    }\n\n    query ($id: String, $Locale: Locale, $LocaleProjection:[Locale!]) {\n      product(id: $id, localeProjection: $LocaleProjection) {\n        id\n        key\n        masterData {\n          current {\n            name(locale: $Locale)\n            nameAllLocales {\n              locale\n              value\n            }\n            masterVariant {\n              ...variantFields\n            }\n            description(locale: $Locale)\n            descriptionAllLocales {\n              locale\n              value\n            }\n            metaTitle(locale: $Locale)\n            metaDescription(locale: $Locale)\n            metaTitleAllLocales {\n              locale\n              value\n            }\n            metaDescriptionAllLocales {\n              locale\n              value\n            }\n            categories {\n              name(locale: $Locale)\n              slug(locale: $Locale)\n            }\n          }\n        }\n        skus\n      }\n    }\n      ",variables:{id:e,Locale:t}}}).execute()).body.data.product;return a||"Product with ID ".concat(e," not found.")}catch(a){return console.error("Error retrieving product by ID ".concat(e,":"),a),"Failed to retrieve product details"}},generateMetaData=async(e,t,a,o,n)=>{const i=localStorage.getItem(I.SH.CT_OBJ_TOKEN);if(!rt)return null===n||void 0===n||n((e=>fetchersFunction_utils_objectSpread(fetchersFunction_utils_objectSpread({},e),{},{notificationMessage:"OpenAI key is missing. Please set it in the settings.",notificationMessageType:"error"}))),null;try{var r,l,s,c;const u=await getProductById(t,a),d=null===u||void 0===u||null===(r=u.masterData)||void 0===r||null===(r=r.current)||void 0===r?void 0:r.name,p=null===u||void 0===u||null===(l=u.masterData)||void 0===l||null===(l=l.current)||void 0===l?void 0:l.categories,v=null===p||void 0===p||null===(s=N()(p).call(p,(e=>null===e||void 0===e?void 0:e.name)))||void 0===s?void 0:s.join(", "),m=V()(c='Product name: "'.concat(d,'", Categories: "')).call(c,v,'"'),g=a?', Locale: "'.concat(a,'"'):"",_=await o(e,m+g,i,rt);return null!==_&&void 0!==_&&_.status&&401==(null===_||void 0===_?void 0:_.status)?void(null===n||void 0===n||n((e=>{var t;return fetchersFunction_utils_objectSpread(fetchersFunction_utils_objectSpread({},e),{},{notificationMessage:null===_||void 0===_||null===(t=_.error)||void 0===t?void 0:t.message,notificationMessageType:"error"})}))):fetchersFunction_utils_objectSpread(fetchersFunction_utils_objectSpread({},_),{},{productId:t})}catch(u){return console.error("Error generating metadata for productID:",t,u),null===n||void 0===n||n((e=>fetchersFunction_utils_objectSpread(fetchersFunction_utils_objectSpread({},e),{},{notificationMessage:"Error generating metadata.",notificationMessageType:"error"}))),null}};function productMetaDataFetchers_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function productMetaDataFetchers_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=productMetaDataFetchers_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=productMetaDataFetchers_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const updateProductMeta=async(e,t,a,o,n,i,r)=>{var s,c,u,d,p,v;const m=i.CTP_API_URL,g=i.CTP_PROJECT_KEY,_=localStorage.getItem(I.SH.CT_OBJ_TOKEN),f=await getProductById(e),b=(null===f||void 0===f||null===(s=f.masterData)||void 0===s||null===(s=s.current)||void 0===s?void 0:s.descriptionAllLocales)||[],h={};for(const l of b)l.locale!==n&&(h[l.locale]=l.value);h[n]=a;let j={},y=null===f||void 0===f||null===(c=f.masterData)||void 0===c||null===(c=c.current)||void 0===c?void 0:l()(u=c.masterVariant.attributesRaw).call(u,(e=>"features"===e.name));if(null!==(d=y)&&void 0!==d&&null!==(d=d.value)&&void 0!==d&&d[0]&&(y.value[0][n]=t||" "),!y){var S;y={name:"features",value:[{[n]:""}]};const e={name:"features",value:[{[n]:""}]};null===f||void 0===f||null===(S=f.masterData)||void 0===S||null===(S=S.current)||void 0===S||S.masterVariant.attributesRaw.push(e),y.value[0][n]=t||" "}j=y.value[0];const D=V()(p=V()(v="".concat(m,"/")).call(v,g,"/products/")).call(p,e),w={Authorization:"Bearer ".concat(_),"Content-Type":"application/json"},R={version:o,actions:[{action:"setDescription",description:h,staged:!1},{action:"setAttributeInAllVariants",name:"features",value:[j],staged:!1}]};try{const e=await G.Z.post(D,R,{headers:w});return null===r||void 0===r||r((e=>productMetaDataFetchers_objectSpread(productMetaDataFetchers_objectSpread({},e),{},{notificationMessage:t?"Description and key features updated successfully.":"Description updated successfully.",notificationMessageType:"success"}))),e.data}catch(k){return null===r||void 0===r||r((e=>productMetaDataFetchers_objectSpread(productMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"Error updating product description and key features.",notificationMessageType:"error"}))),console.error("Error updating product description and key features:",k),null}},queryProductOpenAi=async(e,t,a,o)=>{const n=new ot.ZP({apiKey:o,dangerouslyAllowBrowser:!0});let i="",r="";if(a){var l,s;const t=await getAllSavedRulesFromCtObj(a,e,I.NT,I.k_),o=await getAllSavedRulesFromCtObj(a,e,I.uX,I.UF),n=null===t||void 0===t||null===(l=t.value)||void 0===l?void 0:at()(l).call(l,(e=>/^\s*$/.test(e))),d=null===o||void 0===o||null===(s=o.value)||void 0===s?void 0:at()(s).call(s,(e=>/^\s*$/.test(e)));var c,u;if(!n&&!d)i=null===t||void 0===t||null===(c=t.value)||void 0===c?void 0:c.join(" "),r=null===o||void 0===o||null===(u=o.value)||void 0===u?void 0:u.join(" ")}let d="Find some key features and a precise description for a product with ".concat(t,'. The format for the output should be like this - *Description*:abc and *Key Features*:abc"');var p;i&&r?d+=V()(p=" and Rules for description: ".concat(i," and rules for key features: ")).call(p,r):d+=" and Rules: Include the main keyword in both the title and description. Seperate all the key features ith comma. Give a user engaging description which would be able to put forward the proper explaination about the product and spark curiosity in incoming traffic. Limit the description to under 150-160 characters for full visibility in search results. Give atleast 5 key features, you can give more";try{return await n.chat.completions.create({model:"gpt-4-turbo-preview",temperature:.5,max_tokens:3500,top_p:1,frequency_penalty:0,presence_penalty:0,messages:[{role:"user",content:d}]})}catch(v){return console.error("Error querying OpenAI:",v),null}};function bulkProductMetaDataFetchers_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function bulkProductMetaDataFetchers_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=bulkProductMetaDataFetchers_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=bulkProductMetaDataFetchers_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}function seoMetaDataFetchers_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function seoMetaDataFetchers_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=seoMetaDataFetchers_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=seoMetaDataFetchers_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const updateProductSeoMeta=async(e,t,a,o,n,i,r)=>{var l,s,c,u;const d=e.CTP_API_URL,p=e.CTP_PROJECT_KEY,v=localStorage.getItem(I.SH.CT_OBJ_TOKEN),m=await getProductById(t),g=(null===m||void 0===m||null===(l=m.masterData)||void 0===l||null===(l=l.current)||void 0===l?void 0:l.metaTitleAllLocales)||[],_=(null===m||void 0===m||null===(s=m.masterData)||void 0===s||null===(s=s.current)||void 0===s?void 0:s.metaDescriptionAllLocales)||[],f={};for(const D of g)D.locale!==i&&(f[D.locale]=D.value);f[i]=a;const b={};for(const D of _)D.locale!==i&&(b[D.locale]=D.value);b[i]=o;const h=V()(c=V()(u="".concat(d,"/")).call(u,p,"/products/")).call(c,t),j={Authorization:"Bearer ".concat(v),"Content-Type":"application/json"},y={version:n,actions:[{action:"setMetaTitle",metaTitle:f,staged:!1},{action:"setMetaDescription",metaDescription:b,staged:!1}]};try{const e=await G.Z.post(h,y,{headers:j});return null===r||void 0===r||r((e=>seoMetaDataFetchers_objectSpread(seoMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"SEO title and description updated successfully.",notificationMessageType:"success"}))),e.data}catch(S){return null===r||void 0===r||r((e=>seoMetaDataFetchers_objectSpread(seoMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"Error updating SEO title and description.",notificationMessageType:"error"}))),console.error("Error updating product SEO meta:",S),null}},queryOpenAi=async(e,t,a,o)=>{const n=new ot.ZP({apiKey:o,dangerouslyAllowBrowser:!0});let i="";if(a){var r;const t=getAllSavedRulesFromCtObj(a,e,I._q,I.w1);var l;if(!(null===t||void 0===t||null===(r=t.value)||void 0===r?void 0:at()(r).call(r,(e=>/^\s*$/.test(e)))))i=null===t||void 0===t||null===(l=t.value)||void 0===l?void 0:l.join(" ")}let s="Find the SEO title and description for product with ".concat(t);s+=i?" and Rules: ".concat(i):" and Rules: Include the main keyword in both the title and description. Keep the title concise (50-60 characters) while making it compelling for clicks. Clearly communicate product benefits in the description to engage users and spark curiosity. Limit the description to under 150-160 characters for full visibility in search results.";try{return await n.chat.completions.create({model:"gpt-4-turbo-preview",temperature:.5,max_tokens:3500,top_p:1,frequency_penalty:0,presence_penalty:0,messages:[{role:"user",content:s}]})}catch(c){return c}};function bulkSeoMetaDataFetchers_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function bulkSeoMetaDataFetchers_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=bulkSeoMetaDataFetchers_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=bulkSeoMetaDataFetchers_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}function bulkMetaDataFetchers_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function bulkMetaDataFetchers_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=bulkMetaDataFetchers_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=bulkMetaDataFetchers_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const handleDescBulkGenerateClick=async(e,t,a,o,n,i,r)=>{const s=e.dataLocale,c=e.secrets,u=a.current.api.getSelectedNodes();t.loadingOverlayMessage="Generating description and key features for selected products. This may take some time",a.current.api.showLoadingOverlay();const d=null===o||void 0===o?void 0:N()(o).call(o,(e=>null===e||void 0===e?void 0:e.id)),p=await(async(e,t,a,o)=>{if(!rt)return setNotification(o,"OpenAI key is missing. Please set it in the settings tab.","error"),null;let n=[];const i={dataLocale:a,errorMessage:"Error generating product description and key features in batch.",secrets:e};return await processBatches(t,20,i,generateMetaData,queryProductOpenAi,o,(e=>{n=[...n,...e]})),n})(c,d,s,n),v=[...i];null===p||void 0===p||M()(p).call(p,(e=>{const t=matchData(e),a=t.keyFeatures,o=t.description,n=removeDoubleQuotes(a),i=removeDoubleQuotes(o),r=ye()(v).call(v,(t=>t.id===(null===e||void 0===e?void 0:e.productId)));if(-1!==r){var c,u;const e=null===(c=v[r].masterData.current)||void 0===c||null===(c=c.masterVariant)||void 0===c?void 0:c.attributesRaw;let t=l()(e).call(e,(e=>"features"===e.name)),a=s||"en";t||(t={name:"features",value:[{[a]:""}]},e.push(t)),null!==(u=t)&&void 0!==u&&u.value[0]&&(t.value[0][a]=n),v[r].masterData.current.description=i}})),r(v),le()((()=>{M()(u).call(u,(e=>{var t;null===(t=a.current.api.getRowNode(e.id))||void 0===t||t.setSelected(!0)}))}),0),a.current.api.hideOverlay(),t.loadingOverlayMessage="Loading"},handleSeoBulkGenerateClick=async(e,t,a,o,n,i,r)=>{const l=e.dataLocale,s=e.secrets,c=a.current.api.getSelectedNodes();t.loadingOverlayMessage="Generating SEO metadata for selected products. This may take some time",a.current.api.showLoadingOverlay();const u=null===o||void 0===o?void 0:N()(o).call(o,(e=>null===e||void 0===e?void 0:e.id)),d=await(async(e,t,a,o)=>{if(!rt)return setNotification(o,"OpenAI key is missing. Please set it in the settings.","error"),null;let n=[];const i={dataLocale:a,errorMessage:"Error generating SEO metadata in batch.",secrets:e};return await processBatches(t,20,i,generateMetaData,queryOpenAi,o,(e=>{n=[...n,...e]})),n})(s,u,l,n),p=[...i];null===d||void 0===d||M()(d).call(d,(e=>{const t=seoMatchData(e),a=t.title,o=t.description,n=removeDoubleQuotes(a),i=removeDoubleQuotes(o),r=ye()(p).call(p,(t=>t.id===(null===e||void 0===e?void 0:e.productId)));-1!==r&&(p[r].masterData.current.metaTitle=n,p[r].masterData.current.metaDescription=i)})),r(p),le()((()=>{M()(c).call(c,(e=>{var t;null===(t=a.current.api.getRowNode(e.id))||void 0===t||t.setSelected(!0)}))}),0),a.current.api.hideOverlay(),t.loadingOverlayMessage="Loading"},dataApplication=(e,t,a,o,n)=>{if(e){const o=[...t];M()(e).call(e,(e=>{const t=null===o||void 0===o?void 0:ye()(o).call(o,(t=>(null===t||void 0===t?void 0:t.id)===(null===e||void 0===e?void 0:e.id)));-1!==t&&(o[t].version=null===e||void 0===e?void 0:e.version)})),a(o)}o.current.api.hideOverlay(),n.loadingOverlayMessage="Loading"},handleDescBulkApplyClick=async(e,t,a,o,n,i,r)=>{const s=e.dataLocale,c=e.secrets,u=s||"en";if(null===t||void 0===t?void 0:We()(t).call(t,(e=>!e.masterData.current.description)))a((e=>bulkMetaDataFetchers_objectSpread(bulkMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"Description cannot be empty for selected products.",notificationMessageType:"error"})));else{const e=null===t||void 0===t?void 0:N()(t).call(t,(e=>{var t,a,o;return{productId:null===e||void 0===e?void 0:e.id,keyFeatures:null===e||void 0===e||null===(t=e.masterData)||void 0===t||null===(t=t.current)||void 0===t?void 0:l()(a=t.masterVariant.attributesRaw).call(a,(e=>"features"===e.name)).value[0][u],description:null===e||void 0===e||null===(o=e.masterData)||void 0===o||null===(o=o.current)||void 0===o?void 0:o.description,version:null===e||void 0===e?void 0:e.version}}));o.loadingOverlayMessage="Applying description and key features for selected products. This may take some time",n.current.api.showLoadingOverlay();const d=await(async(e,t,a,o)=>{const n=Math.ceil((null===e||void 0===e?void 0:e.length)/20);let i=[];for(let l=0;l<n;l++){const n=20*l,s=Math.min(20*(l+1),null===e||void 0===e?void 0:e.length),c=null===e||void 0===e?void 0:Ce()(e).call(e,n,s),u=null===c||void 0===c?void 0:N()(c).call(c,(e=>({productId:e.productId,keyFeatures:e.keyFeatures,description:e.description,version:e.version,dataLocale:t})));try{const e=null===u||void 0===u?void 0:N()(u).call(u,(async e=>await updateProductMeta(null===e||void 0===e?void 0:e.productId,null===e||void 0===e?void 0:e.keyFeatures,null===e||void 0===e?void 0:e.description,null===e||void 0===e?void 0:e.version,null===e||void 0===e?void 0:e.dataLocale,a))),t=await et().all(e);o((e=>bulkProductMetaDataFetchers_objectSpread(bulkProductMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"Product description and key features applied successfully.",notificationMessageType:"success"}))),i=[...i,...t]}catch(r){o((e=>bulkProductMetaDataFetchers_objectSpread(bulkProductMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"Error applying description and key features in batch.",notificationMessageType:"error"}))),console.error("Error applying description and key features in batch:",r)}}return i})(e,s,c,a);dataApplication(d,i,r,n,o)}},handleSeoBulkApplyClick=async(e,t,a,o,n,i,r)=>{const l=e.dataLocale,s=e.secrets;if(null===t||void 0===t?void 0:We()(t).call(t,(e=>!e.masterData.current.metaTitle||!e.masterData.current.metaDescription)))n((e=>bulkMetaDataFetchers_objectSpread(bulkMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"SEO Title or description cannot be empty for selected products.",notificationMessageType:"error"})));else{const e=null===t||void 0===t?void 0:N()(t).call(t,(e=>{var t,a;return{productId:null===e||void 0===e?void 0:e.id,metaTitle:null===e||void 0===e||null===(t=e.masterData)||void 0===t||null===(t=t.current)||void 0===t?void 0:t.metaTitle,metaDescription:null===e||void 0===e||null===(a=e.masterData)||void 0===a||null===(a=a.current)||void 0===a?void 0:a.metaDescription,version:null===e||void 0===e?void 0:e.version}}));a.loadingOverlayMessage="Applying SEO meta for selected products. This may take some time",o.current.api.showLoadingOverlay();const c=await(async(e,t,a,o)=>{const n=Math.ceil((null===t||void 0===t?void 0:t.length)/20);let i=[];for(let l=0;l<n;l++){const n=20*l,s=Math.min(20*(l+1),null===t||void 0===t?void 0:t.length),c=null===t||void 0===t?void 0:Ce()(t).call(t,n,s),u=null===c||void 0===c?void 0:N()(c).call(c,(e=>({productId:e.productId,metaTitle:e.metaTitle,metaDescription:e.metaDescription,version:e.version,dataLocale:a})));try{const t=null===u||void 0===u?void 0:N()(u).call(u,(async t=>await updateProductSeoMeta(e,null===t||void 0===t?void 0:t.productId,null===t||void 0===t?void 0:t.metaTitle,null===t||void 0===t?void 0:t.metaDescription,null===t||void 0===t?void 0:t.version,null===t||void 0===t?void 0:t.dataLocale))),a=await et().all(t);o((e=>bulkSeoMetaDataFetchers_objectSpread(bulkSeoMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"SEO metadata applied successfully.",notificationMessageType:"success"}))),i=[...i,...a]}catch(r){o((e=>bulkSeoMetaDataFetchers_objectSpread(bulkSeoMetaDataFetchers_objectSpread({},e),{},{notificationMessage:"Error applying SEO metadata in batch.",notificationMessageType:"error"}))),console.error("Error applying SEO metadata in batch:",r)}}return i})(s,e,l,n);dataApplication(c,i,r,o,a)}},Renderers_ActionRenderButtons=e=>{let t=e.handleGenerate,a=e.handleApply,o=e.allProps;return(0,K.BX)("div",{className:Q,children:[(0,K.tZ)("div",{children:(0,K.tZ)(Ne.Z,{size:"medium",label:"Generate",onClick:()=>t(o),isDisabled:!1})}),(0,K.tZ)("div",{className:W,children:(0,K.tZ)(Ne.Z,{size:"medium",label:"Apply",onClick:()=>a(o.rowIndex),isDisabled:!1})})]})};function ActionRendererSEO_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function ActionRendererSEO_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=ActionRendererSEO_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=ActionRendererSEO_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const ActionRendererSEO=e=>{const t=(0,L.b)().setState,a={CTP_API_URL:(0,oe.UV)((e=>e.environment.apiUrl)),CTP_PROJECT_KEY:(0,oe.UV)((e=>e.environment.projectKey))},o=(0,oe.UV)((e=>{var t;return{dataLocale:e.dataLocale,projectLanguages:null===(t=e.project)||void 0===t?void 0:t.languages}})).dataLocale;return(0,K.tZ)(Renderers_ActionRenderButtons,{handleGenerate:async n=>{var i;e.context.loadingOverlayMessage="Generating meta data",e.gridRef.current.api.showLoadingOverlay();const r=await generateMetaData(a,null===n||void 0===n||null===(i=n.data)||void 0===i?void 0:i.id,o,queryOpenAi,t),l=seoMatchData(r),s=l.title,c=l.description;e.setResponseFromAi({id:n.data.id,title:s,description:c,version:n.data.version}),e.gridRef.current.api.hideOverlay(),e.context.loadingOverlayMessage="Loading"},handleApply:async n=>{var i,r,l;const s=null===e||void 0===e||null===(i=e.gridRef)||void 0===i||null===(i=i.current)||void 0===i||null===(i=i.api)||void 0===i||null===(i=i.getDisplayedRowAtIndex(n))||void 0===i?void 0:i.data;if(null!==s&&void 0!==s&&null!==(r=s.masterData)&&void 0!==r&&r.current){const n=s.masterData.current,i=n.metaTitle,r=n.metaDescription;if(i||r)if(i)if(r){e.context.loadingOverlayMessage="Applying",e.gridRef.current.api.showLoadingOverlay();const n=await updateProductSeoMeta(a,s.id,i,r,s.version,o,t);e.setResponseFromAi((e=>ActionRendererSEO_objectSpread(ActionRendererSEO_objectSpread({},e),{},{version:null===n||void 0===n?void 0:n.version}))),e.gridRef.current.api.hideOverlay(),e.context.loadingOverlayMessage="Loading"}else t((e=>ActionRendererSEO_objectSpread(ActionRendererSEO_objectSpread({},e),{},{notificationMessage:"SEO description cannot be empty.",notificationMessageType:"error"})));else t((e=>ActionRendererSEO_objectSpread(ActionRendererSEO_objectSpread({},e),{},{notificationMessage:"SEO title cannot be empty.",notificationMessageType:"error"})));else t((e=>ActionRendererSEO_objectSpread(ActionRendererSEO_objectSpread({},e),{},{notificationMessage:"SEO title and SEO description cannot be empty.",notificationMessageType:"error"})))}null===(l=e.gridRef)||void 0===l||null===(l=l.current)||void 0===l||null===(l=l.api)||void 0===l||l.stopEditing(!1)},allProps:e})},TableContainer_TableContainer=()=>{const e=(0,P.useState)([]),t=(0,i.Z)(e,2),a=t[0],o=t[1],n=(0,P.useState)(),r=(0,i.Z)(n,2),l=r[0],s=r[1],c=(0,P.useState)(""),u=(0,i.Z)(c,2),d=u[0],p=u[1],v=(0,P.useState)(!1),m=(0,i.Z)(v,2),g=m[0],_=m[1],f=(0,P.useState)([]),b=(0,i.Z)(f,2),h=b[0],j=b[1],y=(0,P.useState)({id:null,title:null,description:null,version:null}),S=(0,i.Z)(y,2),D=S[0],w=S[1],R=(0,P.useRef)(null),k=(0,oe.UV)((e=>{var t;return{dataLocale:e.dataLocale,projectLanguages:null===(t=e.project)||void 0===t?void 0:t.languages}})),O=k.dataLocale,Z=(0,oe.UV)((e=>e.environment.apiUrl)),T=(0,oe.UV)((e=>e.environment.projectKey)),F={CTP_API_URL:Z,CTP_PROJECT_KEY:T},M=(0,P.useMemo)((()=>({actionRenderer:ActionRendererSEO})),[]),E=(0,Se.nU)(),A=E.page,C=E.perPage,I=(0,L.b)(),x=I.state,B=I.setState,V=((null===A||void 0===A?void 0:A.value)-1)*(null===C||void 0===C?void 0:C.value),U=[...Ye,{headerName:"Actions",field:"productKey",flex:2,editable:!1,minWidth:200,sortable:!1,cellRenderer:"actionRenderer",cellRendererParams:{setResponseFromAi:w,gridRef:R}}],q=(0,P.useMemo)((()=>({loadingOverlayMessage:"Loading"})),[]),G=(0,P.useCallback)((()=>{let e=R.current.api.getSelectedRows();j(e)}),[V,null===C||void 0===C?void 0:C.value]),$={dataLocale:O,offSet:V,perPage:C},J={perPage:C,offSet:V};(0,P.useEffect)((()=>{if(null!==D&&void 0!==D&&D.id&&null!==D&&void 0!==D&&D.title&&null!==D&&void 0!==D&&D.description&&null!==D&&void 0!==D&&D.version){const e=[...a],t=ye()(e).call(e,(e=>e.id===D.id));if(-1!==t){const a=removeDoubleQuotes(D.title),n=removeDoubleQuotes(D.description);e[t].masterData.current.metaTitle=a,e[t].masterData.current.metaDescription=n,e[t].version=D.version,o(e)}}}),[D]);const X={dataLocale:O,secrets:F};return(0,K.tZ)(TableContainer_GridContainer,{search:d,setSearch:p,handleSearch:async()=>{const e=await performSearch(Fe,d,$,B,0,0,_);if(e){var t;const a=N()(t=e.body.results).call(t,(e=>{var t,a,o;const n=null===(t=e.name)||void 0===t?void 0:t[O||"en"],i=null===(a=e.metaTitle)||void 0===a?void 0:a[O||"en"],r=null===(o=e.metaDescription)||void 0===o?void 0:o[O||"en"];return{id:e.id,version:e.version,key:e.key,masterData:{current:{name:n,metaTitle:i,metaDescription:r}}}}));o(a),s(e.body.total)}},fetchData:async()=>{await fetchProductData(Fe,O,J,B,s,o,_)},selectedRows:h,handleBulkGenerateClick:()=>handleSeoBulkGenerateClick(X,q,R,h,B,a,o),handleBulkApplyClick:()=>handleSeoBulkApplyClick(X,h,q,R,B,a,o),gridRef:R,state:x,tableData:a,colDefs:U,onSelectionChanged:G,context:q,totalProductCount:l,page:A,perPage:C,searchPerformed:g,searchboxPlaceholder:"Search by Product key, Name, Seo title or Seo description",components:M})};function ActionRendererProductInformation_ownKeys(e,t){var a=m()(e);if(_()){var o=_()(e);t&&(o=b()(o).call(o,(function(t){return j()(e,t).enumerable}))),a.push.apply(a,o)}return a}function ActionRendererProductInformation_objectSpread(e){for(var t=1;t<arguments.length;t++){var a,o,n=null!=arguments[t]?arguments[t]:{};t%2?M()(a=ActionRendererProductInformation_ownKeys(Object(n),!0)).call(a,(function(t){(0,O.Z)(e,t,n[t])})):S()?w()(e,S()(n)):M()(o=ActionRendererProductInformation_ownKeys(Object(n))).call(o,(function(t){k()(e,t,j()(n,t))}))}return e}const ActionRendererProductInformation=e=>{const t={CTP_API_URL:(0,oe.UV)((e=>e.environment.apiUrl)),CTP_PROJECT_KEY:(0,oe.UV)((e=>e.environment.projectKey))},a=(0,L.b)().setState,o=(0,oe.UV)((e=>{var t;return{dataLocale:null===e||void 0===e?void 0:e.dataLocale,projectLanguages:null===(t=e.project)||void 0===t?void 0:t.languages}})).dataLocale;return(0,K.tZ)(Renderers_ActionRenderButtons,{handleGenerate:async n=>{e.context.loadingOverlayMessage="Generating product description and features",e.gridRef.current.api.showLoadingOverlay();try{var i;const r=await generateMetaData(t,null===n||void 0===n||null===(i=n.data)||void 0===i?void 0:i.id,o,queryProductOpenAi,a),l=matchData(r),s=l.keyFeatures,c=l.description;e.setResponseFromAi({id:n.data.id,keyFeatures:s,description:c,version:n.data.version})}catch(r){console.error("Error generating product metadata:",r)}finally{e.gridRef.current.api.hideOverlay(),e.context.loadingOverlayMessage="Loading"}},handleApply:async n=>{var i,r,s;const c=null===e||void 0===e||null===(i=e.gridRef)||void 0===i||null===(i=i.current)||void 0===i||null===(i=i.api)||void 0===i||null===(i=i.getDisplayedRowAtIndex(n))||void 0===i?void 0:i.data;if(null!==c&&void 0!==c&&null!==(r=c.masterData)&&void 0!==r&&r.current){var u;const n=c.masterData.current.description,i=o||"en",r=l()(u=c.masterData.current.masterVariant.attributesRaw).call(u,(e=>"features"===e.name)).value[0][i];if(n||r)if(n){e.context.loadingOverlayMessage="Applying",e.gridRef.current.api.showLoadingOverlay();try{const i=await updateProductMeta(c.id,r,n,c.version,o,t,a);e.setResponseFromAi((e=>ActionRendererProductInformation_objectSpread(ActionRendererProductInformation_objectSpread({},e),{},{version:null===i||void 0===i?void 0:i.version})))}catch(d){console.error("Error updating product metadata:",d)}finally{e.gridRef.current.api.hideOverlay(),e.context.loadingOverlayMessage="Loading"}}else a((e=>ActionRendererProductInformation_objectSpread(ActionRendererProductInformation_objectSpread({},e),{},{notificationMessage:"Description cannot be empty.",notificationMessageType:"error"})));else a((e=>ActionRendererProductInformation_objectSpread(ActionRendererProductInformation_objectSpread({},e),{},{notificationMessage:"Description and Key Features cannot be empty.",notificationMessageType:"error"})))}null===(s=e.gridRef)||void 0===s||null===(s=s.current)||void 0===s||null===(s=s.api)||void 0===s||s.stopEditing(!1)},allProps:e})},TableContainer_DescriptionTableContainer=()=>{const e=(0,oe.UV)((e=>e.environment.apiUrl)),t=(0,oe.UV)((e=>e.environment.projectKey)),a={CTP_API_URL:e,CTP_PROJECT_KEY:t},o=(0,P.useState)([]),n=(0,i.Z)(o,2),r=n[0],s=n[1],c=(0,P.useState)(),u=(0,i.Z)(c,2),d=u[0],p=u[1],v=(0,P.useState)(""),m=(0,i.Z)(v,2),g=m[0],_=m[1],f=(0,P.useState)(!1),b=(0,i.Z)(f,2),h=b[0],j=b[1],y=(0,P.useState)([]),S=(0,i.Z)(y,2),D=S[0],w=S[1],R=(0,P.useState)({id:null,keyFeatures:null,description:null,version:null}),k=(0,i.Z)(R,2),O=k[0],Z=k[1],T=(0,P.useRef)(null),F=(0,oe.UV)((e=>{var t;return{dataLocale:e.dataLocale,projectLanguages:null===(t=e.project)||void 0===t?void 0:t.languages}})),M=F.dataLocale,E=(0,P.useMemo)((()=>({actionRenderer:ActionRendererProductInformation})),[]),A=(0,Se.nU)(),C=A.page,I=A.perPage,x=(0,L.b)(),B=x.state,V=x.setState,U=((null===C||void 0===C?void 0:C.value)-1)*(null===I||void 0===I?void 0:I.value),q=[...He,{headerName:"Actions",field:"productKey",flex:2,editable:!1,minWidth:200,sortable:!1,cellRenderer:"actionRenderer",cellRendererParams:{setResponseFromAi:Z,gridRef:T}}],G=(0,P.useMemo)((()=>({loadingOverlayMessage:"Loading"})),[]),$=(0,P.useCallback)((()=>{let e=T.current.api.getSelectedRows();w(e)}),[U,null===I||void 0===I?void 0:I.value]),J={dataLocale:M,offSet:U,perPage:I},X={perPage:I,offSet:U};(0,P.useEffect)((()=>{if(null!==O&&void 0!==O&&O.id&&null!==O&&void 0!==O&&O.description&&null!==O&&void 0!==O&&O.version){let t=(null===O||void 0===O?void 0:O.keyFeatures)||" ";const a=[...r],o=ye()(a).call(a,(e=>e.id===O.id));if(-1!==o){var e;const n=removeDoubleQuotes(t),i=removeDoubleQuotes(O.description),r=a[o].masterData.current.masterVariant.attributesRaw;let c=l()(r).call(r,(e=>"features"===e.name)),u=M;c||(c={name:"features",value:[{[u]:""}]},r.push(c)),null!==(e=c)&&void 0!==e&&null!==(e=e.value)&&void 0!==e&&e[0]&&(c.value[0][u]=n),a[o].masterData.current.description=i,a[o].version=O.version,s(a)}}}),[O,M]);const H={dataLocale:M,secrets:a};return(0,K.tZ)(TableContainer_GridContainer,{search:g,setSearch:_,handleSearch:async()=>{const e=await performSearch(Fe,g,J,V,0,0,j);if(e){var t;const a=N()(t=e.body.results).call(t,(e=>{var t,a;const o=l()(t=e.masterVariant.attributes).call(t,(e=>"features"===e.name)),n=(null===o||void 0===o?void 0:o.value[0][M])||"",i=e.description||"",r=null===(a=e.name)||void 0===a?void 0:a[M];return{id:e.id,version:e.version,key:e.key,masterData:{current:{name:r,description:null===i||void 0===i?void 0:i[M],masterVariant:{attributesRaw:[{name:"features",value:[{[M]:n}]}]}}}}}));s(a),p(e.body.total)}},fetchData:async()=>{await fetchProductData(Fe,M,X,V,p,s,j)},selectedRows:D,handleBulkGenerateClick:()=>handleDescBulkGenerateClick(H,G,T,D,V,r,s),handleBulkApplyClick:()=>handleDescBulkApplyClick(H,D,V,G,T,r,s),gridRef:T,state:B,tableData:r,colDefs:q,onSelectionChanged:$,context:G,totalProductCount:d,page:C,perPage:I,searchPerformed:h,searchboxPlaceholder:"Search by Product key, Name, description",components:E})},TableContainer_TableData=e=>{let t=e.defaultPage;return(0,K.tZ)("div",{children:(()=>{switch(null===t||void 0===t?void 0:t.title){case he.SEO:return(0,K.tZ)(TableContainer_TableContainer,{});case he.DESCRIPTION:return(0,K.tZ)(TableContainer_DescriptionTableContainer,{});default:return null}})()})},TableContainer_TableDataContainer=()=>{const e=(0,P.useState)(be),t=(0,i.Z)(e,2),a=t[0],n=t[1],r=null===a||void 0===a?void 0:l()(a).call(a,(e=>e.isDefaultSelected)),s=(0,o.$B)();return(0,K.BX)("div",{className:"".concat(ue),children:[(0,K.tZ)(u.Z.Headline,{as:"h2",children:"Generate Product information"}),(0,K.BX)("div",{className:"".concat(fe),children:[(0,K.tZ)(TabToggler_TabToggler,{defaultPage:r,selectedPage:a,setSelectedPage:n}),(0,K.tZ)(d.rU,{to:"".concat(s.url,"/settings"),className:"".concat(ge),children:(0,K.tZ)(c.UG,{size:"scale",color:"primary40"})})]}),r&&(0,K.tZ)(TableContainer_TableData,{defaultPage:r})]})},ApplicationRoutes=e=>{const t=(0,o.$B)(),a=(0,L.b)(),i=a.state,r=a.setState;return(0,K.BX)(K.HY,{children:[(0,K.tZ)(n.Z.Inset,{scale:"l",children:(0,K.BX)(o.rs,{children:[(0,K.tZ)(o.AW,{path:"".concat(t.path,"/settings"),children:(0,K.tZ)(Settings_Settings,{linkToProducts:t.url})}),(0,K.tZ)(o.AW,{children:(0,K.tZ)(TableContainer_TableDataContainer,{})})]})}),(null===i||void 0===i?void 0:i.notificationMessage)&&(0,K.tZ)(Notification_Notification,{successMessage:i.notificationMessage,setSuccessMessage:r,type:i.notificationMessageType})]})};ApplicationRoutes.displayName="ApplicationRoutes";const lt=ApplicationRoutes}}]);
//# sourceMappingURL=7770.routes.a0a0f99cc675266ef450.js.map